# PM100D GUI 噪声滤波功能使用指南

## 功能概述

本系统集成了先进的噪声滤波技术，包括：
- **LMS（最小均方）自适应滤波器**：实时自适应噪声抑制
- **分光路噪声抑制**：利用参考信号消除共模噪声
- **多种滤波模式**：比值法、差值法、归一化比值、LMS自适应、混合方法
- **实时性能监控**：SNR改善、噪声抑制率、收敛状态等

## 快速开始

### 1. 连接设备
- 至少连接2个PM100D设备（一个作为主信号，一个作为参考信号）
- 确保设备工作正常并被软件识别

### 2. 启用噪声滤波
1. 在右侧面板找到"噪声滤波系统"区域
2. 勾选"启用噪声滤波"复选框
3. 系统会自动为选中的设备创建噪声处理器

### 3. 配置设备配对
1. 切换到"分光路设置"选项卡
2. 点击"自动配对"按钮，或手动添加设备配对
3. 确保每个主信号设备都有对应的参考信号设备

### 4. 开始数据采集
1. 选择要监控的设备
2. 点击"开始采集"
3. 系统将同时显示原始数据和滤波后的数据

## 详细功能说明

### 分光路设置选项卡

#### 抑制模式选择
- **比值法**：主信号/参考信号，适用于消除共模噪声
- **差值法**：主信号-k×参考信号，k为自动标定的系数
- **归一化比值**：改进的比值法，具有更好的稳定性
- **LMS自适应**：使用自适应滤波器，实时学习噪声特征
- **混合方法**：结合比值法和LMS的优势

#### 设备配对管理
- **添加配对**：手动指定主信号设备和参考信号设备
- **删除配对**：移除不需要的配对关系
- **自动配对**：系统自动配对相邻的设备

#### 系统标定
- **开始标定**：使用当前数据对系统进行标定
- 标定过程中会自动计算最优的处理参数
- 标定完成后显示标定状态

### LMS参数选项卡

#### 关键参数调整
- **滤波器长度**：8-128抽头，影响滤波器的记忆能力
- **学习率（μ）**：0.001-0.1，控制自适应速度
- **泄漏因子（λ）**：0.9-1.0，防止滤波器发散

#### 自动调整功能
- 启用后系统会自动优化参数以获得最佳性能
- 建议保持启用状态

#### 滤波器控制
- **重置滤波器**：清空滤波器的学习记忆
- **测试滤波器**：使用测试信号验证滤波性能

### 性能监控选项卡

#### 实时性能指标
- **SNR改善**：信号噪声比的改善程度（dB）
- **噪声抑制率**：噪声功率的降低百分比
- **收敛状态**：LMS滤波器是否收敛

#### 处理统计
- 显示每个设备的详细处理统计信息
- 包括样本数、处理效率等指标

#### 数据导出
- **导出滤波数据**：保存原始和滤波后的数据到CSV文件
- **导出性能报告**：生成详细的性能分析报告

## 绘图显示功能

### 显示模式切换
1. **原始数据**：仅显示未处理的原始信号
2. **滤波数据**：仅显示滤波后的信号
3. **对比显示**：上下分布显示原始和滤波信号
4. **SNR分析**：三层显示原始、滤波、SNR改善趋势

### 可选显示功能
- **显示噪声估计**：在图中叠加噪声估计曲线
- **显示统计信息**：在图上显示实时性能指标

## 使用技巧

### 最佳实践

1. **设备选择**
   - 使用相同型号的PM100D设备以获得最佳匹配性能
   - 确保参考信号与主信号有一定相关性但不完全相同

2. **参数调整**
   - 初学者建议使用自动参数调整
   - 有经验的用户可以根据信号特征手动调整参数

3. **模式选择**
   - 对于缓慢变化的噪声：使用比值法或归一化比值法
   - 对于快速变化或复杂噪声：使用LMS自适应或混合方法

4. **监控收敛**
   - 观察性能监控中的收敛状态
   - 如果长时间不收敛，尝试降低学习率或重置滤波器

### 常见问题解决

#### 滤波效果不明显
1. 检查设备配对是否正确
2. 确认参考信号确实包含噪声信息
3. 尝试不同的抑制模式
4. 调整LMS参数（降低学习率或增加滤波器长度）

#### 系统不稳定
1. 降低学习率（μ）
2. 增加泄漏因子（λ）
3. 重置滤波器并重新开始

#### 收敛速度慢
1. 适当提高学习率
2. 确保参考信号质量良好
3. 考虑使用混合方法

## 技术原理

### LMS自适应滤波算法
- 基于梯度下降法的自适应算法
- 实时学习噪声特征并生成相应的抗噪声滤波器
- 具有良好的跟踪能力和稳定性

### 分光路噪声抑制
- 利用两路信号的相关性消除共模噪声
- 适用于激光功率稳定性测量等应用
- 可显著提高测量精度

### 性能评估指标
- **SNR改善**: 20×log₁₀(σ_原始/σ_滤波)
- **噪声抑制率**: 1 - (σ_滤波²/(σ_原始² + σ_噪声²))
- **收敛判据**: 基于权重变化和误差功率的稳定性

## 注意事项

1. **硬件要求**
   - 至少需要2个PM100D设备
   - 确保设备时钟同步以获得最佳性能

2. **软件限制**
   - 滤波处理会增加CPU负载，建议在性能较好的计算机上运行
   - 长时间运行时注意内存使用情况

3. **数据质量**
   - 确保输入信号质量良好，避免饱和或截断
   - 定期检查设备标定状态

4. **安全提示**
   - 在进行重要测量前，建议使用已知信号测试滤波性能
   - 保持原始数据备份以供验证

## 支持与反馈

如有任何问题或建议，请联系开发团队。我们致力于不断改进系统性能和用户体验。
